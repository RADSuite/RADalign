#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
#create temp fasta file for downloadable reference database
temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
#dir.create(temp_fasta)
#write filtered sequence data to temp file
writeXStringSet(sequences, temp_fasta)
print(readLines(temp_fasta, n = 5))
#output file path to temp file
return (temp_fasta)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list))
get_MetaScope_reference <- function(accessions_list) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
#create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
temp_fasta <- tempfile(pattern = "reference_", fileext = ".fasta")
#dir.create(temp_fasta)
#write filtered sequence data to temp file
writeXStringSet(sequences, temp_fasta)
print(readLines(temp_fasta, n = 5))
#output file path to temp file
return (temp_fasta)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
file_path = "{download_location}RADdownload/"
file_name <- file.create("{file_path}/Metascope_reference_db.fasta")
writeXStringSet(sequences, file_name)
print(readLines(file_name, n = 5))
return (file_path)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
file_path = file.path(download_location, "RADdownload")
#file_path = "{download_location}RADdownload/"
full_path = file.path(file_path, "Metascope_reference_db.fasta")
file_name <- file.create(full_path)
writeXStringSet(sequences, file_name)
print(readLines(file_name, n = 5))
return (file_path)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list))
download_RADsynch <- function(pipeline, species_list, download_location = getwd()) {
accessions_list <- get_accession_ids(species_list)
file_paths <- c()
if (pipeline == "MetaScope") {
#accessions_SQLite_tmp_path <- get_MetaScope_accessions(accessions_list)
reference_fasta_tmp_path <- get_MetaScope_reference(accessions_list, download_location)
#file_paths <- c(accessions_SQLite, reference_fasta)
file_paths <- c(reference_fasta_tmp_path)
} else if (pipeline == "Kraken") {
# file_paths <- get_Kraken_files(accessions_list)
file_paths <- c()
}
tmp_folder = zip_files(file_paths)
# folder_location <- download_folder(tmp_folder)
return ("Downloaded Successfully to: {folder_location}")
}
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
file_path = file.path(download_location, "RADdownload")
#file_path = "{download_location}RADdownload/"
full_path = file.path(file_path, "Metascope_reference_db.fasta")
file_name <- file.create(full_path)
writeXStringSet(sequences, file_name)
print(readLines(file_name, n = 5))
return (file_path)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, getwd()))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
file_path = file.path(download_location, "RADdownload")
#file_path = "{download_location}RADdownload/"
full_path = file.path(file_path, "Metascope_reference_db.fasta")
#file_name <- file.create(full_path)
# writeXStringSet(sequences, file_name)
writeXStringSet(sequences, full_path)
print(readLines(file_name, n = 5))
return (file_path)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, getwd()))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
folder_path <- file.path(download_location, "RADdownloads")
download_folder <- dir.create(folder_path, recursive = TRUE)
# file_path = file.path(download_location, "RADdownloads")
# #file_path = "{download_location}RADdownload/"
# full_path = file.path(file_path, "Metascope_reference_db.fasta")
full_path = file.path(download_folder, "Metascope_reference_db.fasta")
#file_name <- file.create(full_path)
# writeXStringSet(sequences, file_name)
writeXStringSet(sequences, full_path)
print(readLines(file_name, n = 5))
return (file_path)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, getwd()))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
folder_path <- file.path(download_location, "RADdownloads")
dir.create(folder_path, recursive = TRUE)
# file_path = file.path(download_location, "RADdownloads")
# #file_path = "{download_location}RADdownload/"
# full_path = file.path(file_path, "Metascope_reference_db.fasta")
full_path = file.path(folder_path, "Metascope_reference_db.fasta")
#file_name <- file.create(full_path)
# writeXStringSet(sequences, file_name)
writeXStringSet(sequences, full_path)
print(readLines(file_name, n = 5))
return (file_path)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, getwd()))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
folder_path <- file.path(download_location, "RADdownloads")
if (!dir.exists(folder_path)) {
dir.create(folder_path, recursive = TRUE)
}
# file_path = file.path(download_location, "RADdownloads")
# #file_path = "{download_location}RADdownload/"
# full_path = file.path(file_path, "Metascope_reference_db.fasta")
full_path = file.path(folder_path, "Metascope_reference_db.fasta")
#file_name <- file.create(full_path)
# writeXStringSet(sequences, file_name)
writeXStringSet(sequences, full_path)
print(readLines(file_name, n = 5))
return (folder_path)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, getwd()))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
folder_path <- file.path(download_location, "RADdownloads")
if (!dir.exists(folder_path)) {
dir.create(folder_path, recursive = TRUE)
}
# file_path = file.path(download_location, "RADdownloads")
# #file_path = "{download_location}RADdownload/"
# full_path = file.path(file_path, "Metascope_reference_db.fasta")
full_path = file.path(folder_path, "Metascope_reference_db.fasta")
#file_name <- file.create(full_path)
# writeXStringSet(sequences, file_name)
writeXStringSet(sequences, full_path)
print(readLines(full_path, n = 5))
return (folder_path)
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, getwd()))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
folder_path <- file.path(download_location, "RADdownloads")
if (!dir.exists(folder_path)) {
dir.create(folder_path, recursive = TRUE)
}
# file_path = file.path(download_location, "RADdownloads")
# #file_path = "{download_location}RADdownload/"
# full_path = file.path(file_path, "Metascope_reference_db.fasta")
file_name = "Metascope_reference_db.fasta"
full_path = file.path(folder_path, file_name)
#file_name <- file.create(full_path)
# writeXStringSet(sequences, file_name)
writeXStringSet(sequences, full_path)
print(readLines(full_path, n = 5))
return (paste0(file_name, " successfully downloaded to ", folder_path))
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, getwd()))
get_MetaScope_reference <- function(accessions_list, download_location) {
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return select sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
print(head(sequences))
# #create temp fasta file for downloadable reference database
# temp_fasta <- tempfile(pattern = "reference_", tmpdir = getwd(), fileext = ".fasta")
# # temp_fasta <- tempfile(pattern = "MetaScope_reference_database_", fileext = ".fasta")
# #dir.create(temp_fasta)
#
# #write filtered sequence data to temp file
# writeXStringSet(sequences, temp_fasta)
# print(readLines(temp_fasta, n = 5))
#
# #output file path to temp file
# return (temp_fasta)
folder_path <- file.path(download_location, "RADdownloads")
if (!dir.exists(folder_path)) {
dir.create(folder_path, recursive = TRUE)
}
# file_path = file.path(download_location, "RADdownloads")
# #file_path = "{download_location}RADdownload/"
# full_path = file.path(file_path, "Metascope_reference_db.fasta")
file_name = "Metascope_reference_db.fasta"
full_path = file.path(folder_path, file_name)
#file_name <- file.create(full_path)
# writeXStringSet(sequences, file_name)
writeXStringSet(sequences, full_path)
print(readLines(full_path, n = 5))
return (paste0("Download successful: ", full_path))
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, getwd()))
source("~/BYU/BIO465/RADalign/R/download_RADsynch.R")
download_MetaScope_reference <- function(accessions_list, download_folder) {
#file details
file_name = "Metascope_reference_db.fasta"
file_path = file.path(download_folder, file_name)
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return selected sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
#use Biostrings to write fasta data for selected sequences to file
writeXStringSet(sequences, file_path)
return (paste0("Download successful: ", file_name))
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, "/Users/myeshagilliland/BYU/BIO465/RADalign/RADdownloads/"))
#' download_RADsynch
#'
#' This function allows users to download files for integration with analysis pipelines, currently supports MetaScope and Kraken.
#'
#' @param pipeline name of pipeline. Valid inputs: ("MetaScope", "Kraken")
#' @param species_list list of species names to download from RADlib.
#'
#' @return This function downloads a zipped folder to the user's working directory, and outputs the location of the downloaded folder.
#'
#' @export
#'
#' @examples
#' download_RADsynch("MetaScope", c("Pseudomonas aeruginosa", "Brucella suis"))
#' > "Downloaded Successfully to: ~/user/Downloads"
download_RADsynch <- function(pipeline, species_list, download_location = getwd()) {
accessions_list <- get_accession_ids(species_list)
download_folder <- file.path(download_location, "RADdownloads")
if (!dir.exists(folder_path)) {
dir.create(folder_path, recursive = TRUE)
}
#file_paths <- c()
if (pipeline == "MetaScope") {
#accessions_SQLite_tmp_path <- get_MetaScope_accessions(accessions_list)
# reference_fasta_tmp_path <- download_MetaScope_reference(accessions_list, download_location)
#file_paths <- c(accessions_SQLite, reference_fasta)
#file_paths <- c(reference_fasta_tmp_path)
download_MetaScope_reference(accessions_list, download_location)
} else if (pipeline == "Kraken") {
# file_paths <- get_Kraken_files(accessions_list)
#file_paths <- c()
print("You chose Kraken")
}
# tmp_folder = zip_files(file_paths)
# folder_location <- download_folder(tmp_folder)
return (paste0("Files downloaded successfully to: ", download_folder))
}
download_MetaScope_reference <- function(accessions_list, download_folder) {
#file details
file_name = "Metascope_reference_db.fasta"
file_path = file.path(download_folder, file_name)
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return selected sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
#use Biostrings to write fasta data for selected sequences to file
writeXStringSet(sequences, file_path)
return (paste0("Download successful: ", file_name))
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, "/Users/myeshagilliland/BYU/BIO465/RADalign/RADdownloads"))
#print(download_RADsynch("MetaScope", c("Pseudomonas aeruginosa", "Brucella suis")))
print(download_RADsynch("MetaScope", c("Pseudomonas aeruginosa", "Brucella suis")))
download_RADsynch <- function(pipeline, species_list, download_location = getwd()) {
accessions_list <- get_accession_ids(species_list)
download_folder <- file.path(download_location, "RADdownloads")
if (!dir.exists(download_folder)) {
dir.create(download_folder, recursive = TRUE)
}
#file_paths <- c()
if (pipeline == "MetaScope") {
#accessions_SQLite_tmp_path <- get_MetaScope_accessions(accessions_list)
# reference_fasta_tmp_path <- download_MetaScope_reference(accessions_list, download_location)
#file_paths <- c(accessions_SQLite, reference_fasta)
#file_paths <- c(reference_fasta_tmp_path)
download_MetaScope_reference(accessions_list, download_location)
} else if (pipeline == "Kraken") {
# file_paths <- get_Kraken_files(accessions_list)
#file_paths <- c()
print("You chose Kraken")
}
# tmp_folder = zip_files(file_paths)
# folder_location <- download_folder(tmp_folder)
return (paste0("Files downloaded successfully to: ", download_folder))
}
download_MetaScope_reference <- function(accessions_list, download_folder) {
#file details
file_name = "Metascope_reference_db.fasta"
file_path = file.path(download_folder, file_name)
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return selected sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
#use Biostrings to write fasta data for selected sequences to file
writeXStringSet(sequences, file_path)
return (paste0("Download successful: ", file_name))
}
acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
print(get_MetaScope_reference(acc_list, "/Users/myeshagilliland/BYU/BIO465/RADalign/RADdownloads"))
print(download_RADsynch("MetaScope", c("Pseudomonas aeruginosa", "Brucella suis")))
#' download_RAD
#'
#' This function allows users to download files for integration with analysis pipelines, currently supports MetaScope and Kraken.
#'
#' @param pipeline name of pipeline. Valid inputs: ("MetaScope", "Kraken")
#' @param species_list list of species names to download from RADlib.
#' @param download_location optional parameter, file path for where downloaded files should go, defaults to working directory
#'
#' @return This function downloads a zipped folder to the user's working directory, and outputs the location of the downloaded folder.
#'
#' @export
#'
#' @examples
#' download_RADsynch("MetaScope", c("Pseudomonas aeruginosa", "Brucella suis"))
#' > "Downloaded Successfully to: ~/user/Downloads"
download_RAD_data <- function(pipeline, species_list, download_location = getwd()) {
accessions_list <- get_accession_ids(species_list)
download_folder <- file.path(download_location, "RADdownloads")
if (!dir.exists(download_folder)) {
dir.create(download_folder, recursive = TRUE)
}
file_paths <- c()
if (pipeline == "MetaScope") {
#accessions_SQLite_tmp_path <- get_MetaScope_accessions(accessions_list)
# reference_fasta_tmp_path <- download_MetaScope_reference(accessions_list, download_location)
reference_file_name <- download_MetaScope_reference(accessions_list, download_location)
file_paths <- c(reference_file_name)
} else if (pipeline == "Kraken") {
# download_Kraken_files(accessions_list)
print("You chose Kraken")
}
return (paste0("Files downloaded successfully to: ", download_folder))
}
download_MetaScope_reference <- function(accessions_list, download_folder) {
#file details
file_name = "Metascope_reference_db.fasta"
file_path = file.path(download_folder, file_name)
#get file path to RADlib
RADlib_path <- system.file("extdata", "RADlib.fa", package = "RADalign")
#use RADlib readSequences function to return selected sequences from RADlib
sequences <- readSequences(RADlib_path, accessions_list)
#use Biostrings to write fasta data for selected sequences to file
writeXStringSet(sequences, file_path)
# if(file.info(file_path)$size > 0) {
#   return (paste0("Download successful: ", file_name))
# } else {
#   return ("Error writing file to ")
# }
return (paste0("Download successful: ", file_name))
}
# acc_list <- c("GCF_000006765.1.1", "GCF_000006765.1.2", "GCF_000006765.1.3", "GCF_000006765.1.4", "GCF_000007505.1.1", "GCF_000007505.1.2", "GCF_000007505.1.3")
#
# print(get_MetaScope_reference(acc_list, "/Users/myeshagilliland/BYU/BIO465/RADalign"))
#
print(download_RAD_data("MetaScope", c("Pseudomonas aeruginosa", "Brucella suis")))
